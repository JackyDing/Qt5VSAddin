<html dir="ltr">
<head>
    <title>'Qt5GuiClass'</title>
    <meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5">
    <link id="LINKURL" rel="stylesheet" href="../../1033/styles.css">
    <!--  -->
    <!-- The SYMBOL tag is used to set the default values for the user-defined symbols.-->
    <!--  -->
    <symbol name='WIZARD_DIALOG_TITLE' type="text" value='Qt5GuiClass'></symbol>
    <symbol name='MEMBER' type="checkbox" value="true"></symbol>
    <symbol name='MULTIPLEINHERITANCE' type="checkbox" value="false"></symbol>
    <symbol name='MEMBERPOINTER' type="checkbox" value="false"></symbol>
    <symbol name='CLASS_NAME' type="text" value=''></symbol>
    <symbol name='BASECLASS_NAME' type="text" value='QWidget'></symbol>
    <symbol name='CPP_NAME' type="text" value=''></symbol>
    <symbol name='H_NAME' type="text" value=''></symbol>
    <symbol name='UI_NAME' type="text" value=''></symbol>
    <symbol name='LOCATION' type="text" value=''></symbol>
</head>
<body bgcolor="buttonface" topmargin="0" leftmargin="0" rightmargin="0" bottommargin="0"
    onload="InitDocument(document);" onkeydown="OnKey();" onkeypress="OnPress();">
    <table class="ONE" height="100%" width="100%" border="0" cellpadding="0" cellspacing="0">
        <colgroup>
            <col width="100%">
            <!--OPEN OF INTRODUCTORY INFORMATION TABLE//-->
            <tr valign="top">
                <td height="79" width="100%" colspan="2">
                    <table class="TWO" border="0" cellpadding="0" cellspacing="0">
                        <colgroup>
                            <col width="12">
                            <col>
                            <col width="12">
                            <tr>
                                <td valign="top" height="12" width="12">
                                    &nbsp;
                                </td>
                                <td valign="top" height="12">
                                    &nbsp;
                                </td>
                                <td valign="top" height="12" width="12">
                                    &nbsp;
                                </td>
                                <td class="IMAGE" valign="bottom" width="110" rowspan="2">
                                    <div class="SMALLA" id="Layer0">
                                        <img class="SMALLEST" src="../../Images/Qt5GuiClass.gif" width="63" height="63" alt=""
                                            border="0">
                                    </div>
                                </td>
                                <td valign="top" height="12" width="6" rowspan="2">
                                    &nbsp;
                                </td>
                            </tr>
                            <tr>
                                <td valign="top" height="65" width="12">
                                    &nbsp;
                                </td>
                                <td valign="top" height="65">
                                    <h4 class="HEAD" id="HEAD">
                                        Welcome to the Qt5 GUI Class Wizard</h4>
                                    <p class="SUBHEAD" id="SUBHEAD">
                                        This wizard will add a new Qt5 GUI class to your project. The wizard creates a .h
                                        and .cpp file. It also creates a new empty form.</p>
                                </td>
                                <td valign="top" height="65" width="12">
                                    &nbsp;
                                </td>
                            </tr>
                            <tr>
                                <td valign="top" class="RULE" colspan="5" height="2">
                                    <table border="0" width="100%" height="1" cellpadding="0" cellspacing="0">
                                        <tr valign="top">
                                            <td height="1" width="100%" bgcolor="buttonshadow">
                                                <img src="../../Images/spacer.gif" height="1" width="1" alt="">
                                            </td>
                                            <td height="1" width="1" bgcolor="window">
                                                <img src="../../Images/spacer.gif" height="1" width="1" alt="">
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                    </table>
                </td>
            </tr>
            <!--CLOSE OF INTRODUCTORY INFORMATION TABLE//-->
            <!--OPEN OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
            <tr valign="top">
                <td valign="top" height="100%">
                    <!--OPEN OF CONTENT AND BUTTON TABLE//-->
                    <table class="ONE" border="0" cellpadding="0" cellspacing="0">
                        <colgroup>
                            <col width="100%">
                            <tr valign="top">
                                <td height="100%">
                                    <!--OPEN OF CONTENT//-->
                                    <table class="CONTENT" border="0" cellpadding="0" cellspacing="0">
                                        <colgroup>
                                            <col width="12">
                                            <col width="185">
                                            <col width="12">
                                            <col width="185">
                                            <col width="12">
                                            <col width="185">
                                            <col width="12">
                                            <tr>
                                                <td valign="top" colspan="7" height="12">
                                                    &nbsp;
                                                </td>
                                            </tr>
                                            <tr valign="top">
                                                <td valign="top" width="12">
                                                </td>
                                                <td valign="top">
                                                    Class name:
                                                </td>
                                                <td valign="top" colspan="2">
                                                    .h file:
                                                </td>
                                                <td valign="top" colspan="2">
                                                    .ui file:
                                                </td>
                                                <td valign="top" width="12">
                                                    &nbsp;
                                                </td>
                                            </tr>
                                            <tr>
                                                <td valign="top" width="12">
                                                </td>
                                                <td valign="top">
                                                    <input id="CLASS_NAME" type="text" name="Text4" onpropertychange="ClassNameChanged();">
                                                </td>
                                                <td valign="top" colspan="2">
                                                    <input id="H_NAME" type="text" name="Text1">
                                                </td>
                                                <td valign="top" colspan="2">
                                                    <input id="UI_NAME" type="text" name="Text3">
                                                </td>
                                                <td valign="top" width="12">
                                                </td>
                                            </tr>
                                            <tr>
                                                <td valign="top" width="12">
                                                </td>
                                                <td valign="top">
                                                    Base class:
                                                </td>
                                                <td valign="top" colspan="2">
                                                    .cpp file:
                                                </td>
                                                <td valign="top" colspan="2">
                                                </td>
                                                <td valign="top" width="12">
                                                </td>
                                            </tr>
                                            <tr>
                                                <td valign="top" width="12">
                                                </td>
                                                <td valign="top">
                                                    <input id="BASECLASS_NAME" type="text" name="Text5">
                                                </td>
                                                <td valign="top" colspan="2">
                                                    <input id="CPP_NAME" type="text" name="Text2">
                                                </td>
                                                <td valign="top" colspan="2">
                                                    Ui Class Inclusion as:
                                                </td>
                                                <td valign="top" width="12">
                                                </td>
                                            </tr>
                                            <tr>
                                                <td valign="top" width="12">
                                                </td>
                                                <td valign="top" rowspan="4" colspan="3">
                                                    <p id="ERROR_FIELD" align="center">
                                                    </p>
                                                </td>
                                                <td valign="top" colspan="1">
                                                </td>
                                                <td valign="top" colspan="2">
                                                    <input id="MEMBER" type="radio" name="inclusion" checked>
                                                    member
                                                </td>
                                                <td valign="top" width="12">
                                                </td>
                                            </tr>
                                            <tr>
                                                <td valign="top" width="12">
                                                </td>
                                                <td valign="top" colspan="1">
                                                </td>
                                                <td valign="top" colspan="2">
                                                    <input id="MULTIPLEINHERITANCE" type="radio" name="inclusion">
                                                    multiple Inheritance
                                                </td>
                                                <td valign="top" width="12">
                                                </td>
                                            </tr>
                                            <tr>
                                                <td valign="top" width="12">
                                                </td>
                                                <td valign="top" colspan="1">
                                                </td>
                                                <td valign="top" colspan="2">
                                                    <input id="MEMBERPOINTER" type="radio" name="inclusion">
                                                    member pointer
                                                </td>
                                                <td valign="top" width="12">
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="height: 20px" valign="top" width="12">
                                                </td>
                                                <td style="height: 20px" valign="top" colspan="1">
                                                </td>
                                                <td style="height: 20px" valign="top" colspan="2">
                                                    <input id="LOWER_CASE" type="checkbox" checked name="Checkbox2" onpropertychange="LowerCaseChanged();">Lower
                                                    case file names
                                                </td>
                                                <td style="height: 20px" valign="top" width="12">
                                                </td>
                                            </tr>
                                            <tr>
                                                <td valign="top" height="50px">
                                                    &nbsp;
                                                </td>
                                            </tr>
                                            <tr>
                                                <td valign="top" width="12" style="height: 25px">
                                                </td>
                                                <td valign="top" style="width: 500px; height: 25px" colspan="3">
                                                    Location:
                                                    <input id="LOCATION" type="text" name="Text6" style="width: 330px" size="36">
                                                </td>
                                                <td style="height: 25px" valign="top" colspan="2">
                                                    <input id="Button1" type="button" name="button" value="Browse..." onclick="ShowBrowseDialog();">
                                            </tr>
                                            <tr>
                                                <td valign="top" height="100%">
                                                    &nbsp;
                                                </td>
                                            </tr>
                                    </table>
                                    <!--CLOSE OF CONTENT//-->
                                </td>
                            </tr>
                            <tr valign="bottom">
                                <td height="48">
                                    <!--OPEN OF BUTTON HTML//-->
                                    <table height="48" border="0" cellpadding="0" cellspacing="0">
                                        <colgroup>
                                            <col width="12">
                                            <col>
                                            <col width="75">
                                            <col width="4">
                                            <col width="75">
                                            <col width="4">
                                            <col width="75">
                                            <col width="12">
                                            <tr>
                                                <td valign="top" class="RULE" colspan="8" height="2">
                                                    <table border="0" width="100%" height="1" cellpadding="0" cellspacing="0">
                                                        <tr valign="top">
                                                        </tr>
                                                    </table>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td valign="top" height="11" colspan="8">
                                                    &nbsp;
                                                </td>
                                            </tr>
                                            <tr>
                                                <td valign="middle" height="23" width="12">
                                                    &nbsp;
                                                </td>
                                                <td valign="top" height="23">
                                                    &nbsp;
                                                </td>
                                                <td valign="middle" height="23" width="75">
                                                    <button class="BUTTONS" id="FinishBtn" accesskey="F" onclick="OnFinish(document);"
                                                        type="button">
                                                        <u>F</u>inish</button>
                                                </td>
                                                <td valign="middle" height="23" width="4">
                                                    &nbsp;
                                                </td>
                                                <td valign="middle" height="23" width="75">
                                                    <button class="BUTTONS" id="CancelBtn" accesskey="C" onclick="window.external.Finish(document, 'cancel');"
                                                        type="button">
                                                        <u>C</u>ancel</button>
                                                </td>
                                                <td valign="middle" height="23" width="4">
                                                    &nbsp;
                                                </td>
                                                <td valign="middle" height="23" width="75">
                                                    <button class="BUTTONS" id="HelpBtn" accesskey="H" onclick="window.external.OnHelp('vc.appwiz.custom.overview');"
                                                        type="button" disabled>
                                                        <u>H</u>elp</button>
                                                </td>
                                                <td valign="middle" height="23" width="12">
                                                    &nbsp;
                                                </td>
                                            </tr>
                                            <tr>
                                                <td valign="top" height="12" colspan="8">
                                                    &nbsp;
                                                </td>
                                            </tr>
                                    </table>
                                    <!--CLOSE OF BUTTON HTML//-->
                                </td>
                            </tr>
                    </table>
                    <!--CLOSE OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
                </td>
            </tr>
    </table>
</body>
</html>
<script language="JSCRIPT">
    var QtEngine;
    var dte;
    // Called when the class name changes
    function ClassNameChanged() {
        LowerCaseChanged();
    }

    function LowerCaseChanged() {
        var strClassName = CLASS_NAME.value;
        var idx = strClassName.lastIndexOf('::');
        if (idx >= 0)
            strClassName = strClassName.substr(idx + 2);

        if (LOWER_CASE.checked) {
            strClassName = strClassName.toLowerCase();
        }

        H_NAME.value = strClassName + ".h";
        CPP_NAME.value = strClassName + ".cpp";
        UI_NAME.value = strClassName + ".ui";
    }

    function ShowBrowseDialog() {
        LOCATION.value = QtEngine.ShowOpenFolderDialog(LOCATION.value);
    }

    function IsValid() {
        var testVal = CLASS_NAME.value;
        var idx = testVal.lastIndexOf('::');
        if (idx >= 0)
            testVal = testVal.substr(idx + 2);

        if (!window.external.dte.VCLanguageManager.ValidateIdentifier(testVal) ||
            window.external.dte.VCLanguageManager.IsReservedName(testVal)) {
            window.external.ReportError("Not a valid class name");
            CLASS_NAME.focus();
            return false;
        }

        testVal = BASECLASS_NAME.value;
        if (!window.external.dte.VCLanguageManager.ValidateIdentifier(testVal) ||
            window.external.dte.VCLanguageManager.IsReservedName(testVal)) {
            window.external.ReportError("Not a valid base class name");
            BASECLASS_NAME.focus();
            return false;
        }

        testVal = H_NAME.value;
        if (!window.external.dte.VCLanguageManager.ValidateFileName(testVal)) {
            window.external.ReportError("Not a valid .h file name");
            H_NAME.focus();
            return false;
        }

        if (window.external.ProjectObject.Object.Files.Item(testVal)) {
            window.external.ReportError(".h File already exists");
            H_NAME.focus();
            return false;
        }

        testVal = UI_NAME.value;
        if (window.external.ProjectObject.Object.Files.Item(testVal)) {
            window.external.ReportError(".ui File already exists");
            UI_NAME.focus();
            return false;
        }
        testVal = testVal.toLowerCase().replace(".h", ".x"); // don't validate .h files...
        testVal = testVal.replace(".ui", ".h");
        if (!window.external.dte.VCLanguageManager.ValidateFileName(testVal)) {
            window.external.ReportError("Not a valid .ui file name");
            UI_NAME.focus();
            return false;
        }

        testVal = CPP_NAME.value;
        if (!window.external.dte.VCLanguageManager.ValidateFileName(testVal)) {
            window.external.ReportError("Not a valid .cpp file name");
            CPP_NAME.focus();
            return false;
        }

        if (window.external.ProjectObject.Object.Files.Item(testVal)) {
            window.external.ReportError(".cpp File already exists");
            CPP_NAME.focus();
            return false;
        }

        testVal = LOCATION.value;
        if (testVal.length == 0) {
            window.external.ReportError("Not a valid location directory!");
            LOCATION.focus();
            return false;
        }

        return true;
    }

    // This is an example of a function which initializes the page
    //
    function InitDocument(document) {
        setDirection();

        dte = window.external.dte;
        if (!dte) {
            window.external.ReportError("Cannot find automation object!");
            return false;
        }
        var version = dte.version;
        if (version == "8.0")
            QtEngine = new ActiveXObject("Digia.Qt5ProjectEngine80");
        else if (version == "9.0")
            QtEngine = new ActiveXObject("Digia.Qt5ProjectEngine90");
        else if (version == "10.0")
            QtEngine = new ActiveXObject("Digia.Qt5ProjectEngine100");
        else if (version == "11.0")
            QtEngine = new ActiveXObject("Digia.Qt5ProjectEngine110");
        else if (version == "12.0")
            QtEngine = new ActiveXObject("Digia.Qt5ProjectEngine120");
        else {
            window.external.ReportError("Cannot instantiate QtProjectEngine object!");
            return false;
        }

        if (window.external.FindSymbol('DOCUMENT_FIRST_LOAD')) {
            // This function sets the default symbols based
            // on the values specified in the SYMBOL tags above
            //
            window.external.SetDefaults(document);
        }

        // Load the document and initialize the controls
        // with the appropriate symbol values
        //
        InitControls();
        window.external.Load(document);
        var projFile = window.external.ProjectObject.FullName;
        var i = projFile.lastIndexOf("\\");
        LOCATION.value = projFile.substring(0, i);
    }

    function InitControls() {
        if (!QtEngine.IsSelectedProjectQt(dte)) {
            DisableControls();
            ERROR_FIELD.innerHTML = "<font size=3 color=#990000><BR>It is impossible to add a QtGuiClass to the current project"
            + ", as it was not created using Qt5VSAddin.</font>";
        }
    }

    function DisableControls() {
        FinishBtn.disabled = true;
        CLASS_NAME.disabled = true;
        BASECLASS_NAME.disabled = true;
        CPP_NAME.disabled = true;
        H_NAME.disabled = true;
        UI_NAME.disabled = true;
        LOCATION.disabled = true;
        MEMBER.disabled = true;
        MULTIPLEINHERITANCE.disabled = true;
        MEMBERPOINTER.disabled = true;
        LOWER_CASE.disabled = true;
        Button1.disabled = true;
    }

    // If the wizard has more than 1 page, this
    // function will browse to the page specified
    //
    function Next(document, linkto) {
        window.external.Next(document, linkto);
    }

    // This is an example of a function which
    // gets called when the user clicks on 'Finish'
    //
    function OnFinish(document) {
        if (!IsValid())
            return;

        OnWizFinish(document);
    }

</script>
<script id="INCLUDE_SCRIPT" language="JSCRIPT"></script>
<script id="INCLUDE_COMMON" language="JSCRIPT"></script>
<!--
Common.js is a script file which contains the helper functions
used by the wizards.  Include this line if you want to
call these functions from your html scripts.
//-->
<script>
    var strPath = window.external.FindSymbol("PRODUCT_INSTALLATION_DIR");
    strPath += "VCWizards/";
    strPath += window.external.GetHostLocale();

    // verify if the locale folder really exists
    var fso = new ActiveXObject("Scripting.FileSystemObject");
    var found = fso.FolderExists(strPath)
    if (found == false) {
        strPath = window.external.FindSymbol("PRODUCT_INSTALLATION_DIR");
        strPath += "VCWizards/";
        var folder = fso.GetFolder(strPath);
        for (subfolders = new Enumerator(folder.SubFolders); !subfolders.atEnd(); subfolders.moveNext()) {
            for (files = new Enumerator(subfolders.item().files); !files.atEnd(); files.moveNext()) {
                if (files.item().name.toLowerCase().localeCompare("common.js") == 0) {
                    found = true;
                    strPath += subfolders.item().name;
                    break;
                }
            }
            if (found == true)
                break;
        }
    }

    var strScriptPath = strPath + "/Script.js";
    var strCommonPath = strPath + "/Common.js";
    document.scripts("INCLUDE_SCRIPT").src = strScriptPath;
    document.scripts("INCLUDE_COMMON").src = strCommonPath;
</script>
